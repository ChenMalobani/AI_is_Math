<!DOCTYPE html>
<html lang="en">
  <!-- Beautiful Jekyll | MIT license | Copyright Dean Attali 2016 -->
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, viewport-fit=cover">

  <title>Edge detection</title>

  <meta name="author" content="Yoni Chechik" />

  
  <meta name="description" content="Ex3">
  

  <link rel="alternate" type="application/rss+xml" title="AI is Math - AI is Math is my (Yoni Chechik) computer vision course site- including notes and ipython notebooks, and yes, we also have neural networks" href="/feed.xml" />

  

  

  
<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-146360757-1', 'auto');
    ga('send', 'pageview');
</script>
<!-- End Google Analytics -->



  
    
      
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css" />


    
  

  
    
      <link rel="stylesheet" href="/css/bootstrap.min.css" />
    
      <link rel="stylesheet" href="/css/bootstrap-social.css" />
    
      <link rel="stylesheet" href="/css/main.css" />
    
  

  
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
    
  

  

  

  

    <!-- Facebook OpenGraph tags -->
  


  <meta property="og:site_name" content="AI is Math" />


  
  <meta property="og:title" content="Edge detection" />
  

   
  <meta property="og:description" content="Ex3">
  


  <meta property="og:type" content="website" />

  
  <meta property="og:url" content="/pages/c_03_edge_detection/ex3/" />
  <link rel="canonical" href="/pages/c_03_edge_detection/ex3/" />
  

  
  <meta property="og:image" content="https://raw.githubusercontent.com/YoniChechik/AI_is_Math/master/docs/pages/c_03_edge_detection/c_03_bigimg.jpg" />
  


  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <meta name="twitter:creator" content="@" />

  
  <meta name="twitter:title" content="Edge detection" />
  

  
  <meta name="twitter:description" content="Ex3">
  

  
  <meta name="twitter:image" content="https://raw.githubusercontent.com/YoniChechik/AI_is_Math/master/docs/pages/c_03_edge_detection/c_03_bigimg.jpg" />
  

  

  



  
  <!-- Loading mathjax macro -->
  <!-- Load mathjax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
  <!-- MathJax configuration -->
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true,
          processEnvironments: true
      },
      // Center justify equations in code and markdown cells. Elsewhere
      // we use CSS to left justify single line equations in code cells.
      displayAlign: 'center',
      "HTML-CSS": {
          styles: {'.MathJax_Display': {"margin": 0}},
          linebreaks: { automatic: true }
      }
  });
  </script>


  
  
  <!-- add favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.png?">

</head>


  <body>

    

  
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button><a class="navbar-brand" href="/">AI is Math</a></div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
          <li class="navlinks-container">
            <a class="navlinks-parent" href="javascript:void(0)">About the course</a>
            <div class="navlinks-children">
              <a href="/pages/how2start/how2start/">How to start?</a>
              <a href="/pages/toc/">Table of contents</a>
              <a href="/pages/python_pycharm_installation/python_pycharm_installation/">Python installation</a>
            </div>
          </li>
        
          <li><a href="/pages/about_me/">About me</a></li></ul>
    </div>

	
	<div class="avatar-container">
	  <div class="avatar-img-border">
	    <a href="/">
	      <img class="avatar-img" src="/img/yoni_logo.png" alt="avatar-img"/>
		</a>
	  </div>
	</div>
	

  </div>
</nav>


    <!-- TODO this file has become a mess, refactor it -->




  <div id="header-big-imgs" data-num-img=1
    
	  
	  
	    
		  data-img-src-1="/pages/c_03_edge_detection/c_03_bigimg.jpg"
		
	  
    
  ></div>


<header class="header-section has-img">

<div class="big-img intro-header">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-heading">
          <h1>Edge detection</h1>
		  
		    
            <hr class="small">
            <span class="page-subheading">Ex3</span>
			
		  
		  
		  
        </div>
      </div>
    </div>
  </div>
  <span class='img-desc'></span>
</div>

</header>





<div class="container" role="main">
  <div class="row">
    <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-12 col-sm-offset-0 col-xs-12 col-sx-offset-0">
      <h1 id="ex3-bilateral-filter">EX3: Bilateral filter</h1>

<p>Ex2 raw .py files are available for download in a .zip file <a href="https://github.com/YoniChechik/AI_is_Math/raw/master/c_03_edge_detection/ex3/ex3.zip">(direct download)</a>. Instructions are inside .py file.</p>

<p>Colab links are also available for online solving:</p>
<ul>
  <li>ex3 - bilateral filter <a href="https://colab.research.google.com/github/YoniChechik/AI_is_Math/blob/master/c_03_edge_detection/ex3/ex3.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></li>
</ul>

<h2 id="background">Background</h2>

<p>Ordinary smoothing of an image impact the edges and make them less sharp.
The bilateral filter is a filter that is considered “edge-aware”:
If regular smoothing is done by taking all neighbooring pixels and suming them with weights only dependent by the distance from the chosen pixel (spatial kernel), in the bilateral filter the weight is also determined by the <strong>distance of the intensities</strong> of each neighbooring pixel (range kernel).</p>

<p>With the range dependance, nighbooring pixels that are far in the intensity values(different sides of same edge), will be less important in the weighting.
With this filter, we can smooth the image butkeep the edges intact! this is also a good enhancement for te Canny edge detector - we’ll use the bilateral filter instead of ordinary gaussian blur.</p>

<p>Let’s look at the math (modified from Wikipedia):</p>

<script type="math/tex; mode=display">I^\text{filtered}(x) = \frac{\sum_{x_i \in \Omega_x} I(x)w_p(x,x_i)}{\sum_{x_i \in \Omega_x} w_p(x,x_i)}</script>

<p>and:</p>

<script type="math/tex; mode=display">w_p(x,x_i) = g_s(\|x_i - x\|)f_r(\|I(x_i) - I(x)\|)</script>

<p>where:</p>

<ul>
  <li>$I^\text{filtered}$ is the filtered image.</li>
  <li>$I$ is the original input image to be filtered.</li>
  <li>$x$ are the coordinates of the current pixel to be filtered.</li>
  <li>$\Omega_x$ is the neighboorhood of $x$.</li>
  <li>$f_r$ is the range kernel for smoothing differences in intensities.</li>
  <li>$g_s$ is the spatial (or domain) kernel for smoothing differences in coordinates.</li>
</ul>

<p>Let’s write it in 2D image form, where $f_r$ and $g_s$ are gaussian functions:</p>

<script type="math/tex; mode=display">I^{filtered}(x, y) = \frac{\sum_{i, j} I(i, j) w_p(x, y, i, j)}{\sum_{i, j} w_p(x, y, i, j)}</script>

<p>where:</p>

<script type="math/tex; mode=display">w_p(x, y, i, j) = \exp\left(-\frac{(x-i)^2 + (y-j)^2}{2 \sigma_d^2}\right)\cdot  \exp\left(- \frac{(I(x, y) - I(i, j))^2}{2 \sigma_r^2}\right)</script>

<p>This is an Image showing the full filter on one pixel input.
(In the most right, the half transparent image is the result of applying the filter to all of the pixels).
A regular gaussian (spatial) filter would have resulted in a slop connecting the to planes, but the bilateral filter has better results!</p>

<p><img src="https://github.com/YoniChechik/AI_is_Math/raw/master/c_03_edge_detection/site_metadata/bilateral_filter.png" alt="" /></p>

	    
    </div>
  </div>
</div>


    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links"><li><a href="mailto:chechik.yoni@gmail.com" title="Email me"><span class="fa-stack fa-lg" aria-hidden="true">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                </span>
                <span class="sr-only">Email me</span>
              </a>
            </li><li><a href="https://github.com/YoniChechik/AI_is_Math" title="GitHub"><span class="fa-stack fa-lg" aria-hidden="true">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
                <span class="sr-only">GitHub</span>
              </a>
            </li><li><a href="https://linkedin.com/in/yoni-chechik-9b3173123" title="LinkedIn"><span class="fa-stack fa-lg" aria-hidden="true">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                </span>
                <span class="sr-only">LinkedIn</span>
              </a>
            </li></ul>
      <p class="copyright text-muted">
      Yoni Chechik
      &nbsp;&bull;&nbsp;
      2020

      
      &nbsp;&bull;&nbsp;
      <a href="">AIisMath.com</a>
      

      
      </p>
          <!-- Please don't remove this, keep my open source work credited :) -->
    <p class="theme-by text-muted">
      Theme by
      <a href="https://deanattali.com/beautiful-jekyll/">beautiful-jekyll</a>
    </p>
      </div>
    </div>
  </div>
</footer>

  
    


  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script>
      	if (typeof jQuery == 'undefined') {
          document.write('<script src="/js/jquery-1.11.2.min.js"></scr' + 'ipt>');
      	}
      </script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/js/bootstrap.min.js"></script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/js/main.js"></script>
    
  






  
  </body>
</html>
